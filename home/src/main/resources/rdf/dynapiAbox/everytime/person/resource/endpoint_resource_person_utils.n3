@prefix rdf:  			<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:  			<http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:   			<http://www.w3.org/2002/07/owl#> .
@prefix vitro: 			<http://vitro.mannlib.cornell.edu/ns/vitro/0.7#> .
@prefix dynapi: 		<https://vivoweb.org/ontology/vitro-dynamic-api#> .
@prefix dynapi_java: 	        <java:edu.cornell.mannlib.vitro.webapp.dynapi.components#> .
@prefix xsd: 			<http://www.w3.org/2001/XMLSchema#> .
@prefix position_parameter:     <https://vivoweb.org/procedure/position/parameter/> .
@prefix position_condition:     <https://vivoweb.org/condition/position/> .
@prefix iteration_parameter:    <https://vivoweb.org/iteration_parameter/> .
@prefix whitelist_access:       <https://vivoweb.org/procedure/person/access/> .
@prefix person_condition:       <https://vivoweb.org/condition/person/> .
@prefix person_parameter:       <https://vivoweb.org/procedure/person/parameter/> .
@prefix unpacking_properties:   <https://vivoweb.org/procedure/person_position/unpacking_properties/> .

##########################
## Unpacking operations ##
##########################

unpacking_properties:get_organisation_unit_uri
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:organizationUnitURI_key ;
        dynapi:providesParameter                position_parameter:organizationUnitURI .

unpacking_properties:get_organisation_unit_name
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:organizationUnitName_key ;
        dynapi:providesParameter                position_parameter:organizationUnitName .

unpacking_properties:get_position_name
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:positionName_key ;
        dynapi:providesParameter                position_parameter:positionName .

unpacking_properties:get_position_type
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:positionType_key ;
        dynapi:providesParameter                position_parameter:positionType .

unpacking_properties:get_start_date
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:startDate_key ;
        dynapi:providesParameter                position_parameter:startDate .

unpacking_properties:get_end_date
        a                                       dynapi:ContainerQuery ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:endDate_key ;
        dynapi:providesParameter                position_parameter:endDate .

###############################################
### PARAMETER CHECKS
###############################################

# Person attributes

person_condition:first_name_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person first name is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:first_name .

person_condition:middle_name_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person middle name is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:middle_name .

person_condition:last_name_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person last name is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:last_name .

person_condition:type_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person type is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:type .

person_condition:internal_id_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person internal ID is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:internalID .

person_condition:orcid_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person ORCID is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:ORCID .

person_condition:scopus_author_id_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person SCOPUS author id is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:SCOPUSAuthorID .

person_condition:researcher_id_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person researcher ID is defined"@en-US ;
        dynapi:requiresParameter                person_parameter:ResearcherID .

person_condition:positions_check
        a                                       dynapi:ConditionIsNotEmpty ;
        rdfs:label                              "condition if person positions are defined"@en-US ;
        dynapi:requiresParameter                person_parameter:positions .

# Person position container keys

position_condition:contains_organisation_unit_uri_key
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:organizationUnitURI_key .

position_condition:contains_organisation_unit_name_key 
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:organizationUnitName_key .

position_condition:contains_position_name_key
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:positionName_key .

position_condition:contains_position_type_key
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:positionType_key .

position_condition:contains_start_date_key
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:startDate_key .

position_condition:contains_end_date_key
        a                                       dynapi:ConditionContainerContains ;
        dynapi:targetContainer                  iteration_parameter:current_positions_item ;
        dynapi:requiresParameter                position_parameter:endDate_key .

###############################################
### ACCESS CONTROL
###############################################

whitelist_access:admin
        a                                       dynapi:GroupAccessWhitelist ;
        dynapi:userGroup                        <https://vivoweb.org/ontology/vitro-dynamic-api/user-group/admin> .